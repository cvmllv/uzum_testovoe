# Uzum

## Задача

Возвраты товаров представляют серьезную проблему для онлайн маркетплейсов. Статистика показывает, что примерно от 15% до 40% всех онлайн покупок возвращаются, что не только создает финансовые трудности для бизнеса, но также влечет за собой серьезные экологические проблемы из-за огромного количества товаров, оканчивающих свой путь на свалках. Чтобы сократить количество возвратов, продавцам критически важно уметь выявлять причины возврата как можно раньше. Однако часто эта информация становится доступной только после значительного количества возвратов товара. Понимание причин возврата товаров и их предсказание могут значительно помочь уменьшить эту проблему.

## Цель

Разработать модель машинного обучения, которая будет решать задачу многоклассовой классификации и предсказывать распределение вероятностей причин возврата товара на основе множества факторов, включая текстовые отзывы клиентов.

## Что  я имею

![Диаграмма.drawio.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/442a0d83-ace8-49a0-9acc-91e380296dc7/8429a2a8-3186-46e3-819a-e086e68c133a/%D0%94%D0%B8%D0%B0%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%B0.drawio.png)

## Проблемы, я с которыми столкнулась:

1. Отзывы на товар не одного языка. Есть отзывы на русском на кириллице, на узбекском на кириллице и на узбекском на латинице. Также некоторые пишут в отзывах на узбекском языке слова на русском латиницей. Поэтому предобученные модели как BERT отпадают. Остается использовать Word2Vec или TF-IDF.
2. У одного и того же товара могут быть несколько разных причин возврата.
    
    ![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/442a0d83-ace8-49a0-9acc-91e380296dc7/8cd80e92-ab80-40fa-b72d-2ad45070dca2/Untitled.png)
    
3. The number of category_id and category_title is not the same. Size of catgory title is much more than category_id. It means some of the category_id are duplicated in different category_title.
4. 

## Гипотезы

1. **Влияет ли описание товара на количество возвратов. Посчитать количество слов в описании.**
Да, влияет. Чем лучше описание, тем меньше количество возвратов.
    
    ![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/442a0d83-ace8-49a0-9acc-91e380296dc7/7d487f17-b0c4-4c65-9b9a-5a046ed5e31f/Untitled.png)
    
2. **Влияет ли рейтинг товара на количество возвратов?**
    
    Да. Чем выше рейтинг, тем больше количество возратов.
    
    ![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/442a0d83-ace8-49a0-9acc-91e380296dc7/54bbfc5a-7416-45cb-93ea-37eda1517455/Untitled.png)
    
3. **Каково влияние количества отзывов на количество отказов?**
    
    Чем меньше отзывов, тем вероятнее от товара откажутся
    
    ![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/442a0d83-ace8-49a0-9acc-91e380296dc7/83cb87a7-38b8-4455-bb89-fa112b5ebde9/Untitled.png)
    
4. 

Финальна таблица для трейна модели:

| Фича | Описание |
| --- | --- |
| product_id |  |
| wcount_description | количество слов в описание товара |
| category_title | категории, которые по которым происходил отказ |
| category_rating_avg | усредненный рейтинг за категорию |
| shop_rating_avg | усредненный рейтинг по магазинам |
| shop_return_coefficient | коэффициент возврата среди магазинов |
| average_rating | усредненный рейтинг за продукт |
| count_comments_review | количество комментариев по продукту |
| comments | сконкатинированные отзывы по продукту и комментарии возрата тоже по продукту |
| most_frequent_cause | ТАРГЕТ. преобладающая причина отказа от товара |

Для обучения можно попробовать использовать обычную логистическую регрессию и деревья (бустинги XGBoost, CatBoost) так как у меня много категориальных фичей. 

Для начала нужно использовать LabelEncoder() для category_title.

Нужно сделать предобработку теста и убрать все эмоджи

Затем TF-IDF для комментариев

и можно обучать модель.